---
title: "Como Exportar para Neo4j"
subtitle: "Guia pr√°tico para criar knowledge graphs a partir de anota√ß√µes Synesis"
---

# Como Exportar para Neo4j

Este guia mostra **como transformar suas anota√ß√µes Synesis em um grafo de conhecimento no Neo4j**, permitindo an√°lises avan√ßadas de rede, visualiza√ß√µes interativas e integra√ß√£o com sistemas de GraphRAG.

**Voc√™ deve usar este guia se:**

- Precisa visualizar rela√ß√µes complexas entre conceitos
- Quer calcular m√©tricas de centralidade, comunidades ou PageRank
- Precisa integrar com sistemas de IA (Claude Desktop via MCP)
- Quer an√°lises de rede para publica√ß√µes acad√™micas

---

## Pr√©-requisitos

- Python 3.11+ instalado
- Projeto Synesis compil√°vel (v√°lido)
- Neo4j Desktop ou Neo4j Cloud (AuraDB)

---

## Passo 1: Instalar Neo4j

### Op√ß√£o A: Neo4j Desktop (Recomendado para desenvolvimento local)

1. Baixe Neo4j Desktop: https://neo4j.com/download/
2. Instale e crie um novo projeto
3. Crie um novo banco de dados (DBMS):
   - Nome: `synesis-knowledge-graph`
   - Password: escolha uma senha forte
   - Vers√£o: 5.x (√∫ltima dispon√≠vel)
4. Inicie o banco de dados (bot√£o "Start")

:::{.callout-note}
## Checkpoint ‚úì
Abra o Neo4j Browser (bot√£o "Open") e execute:
```cypher
RETURN "Hello, Neo4j!" AS message
```
Se retornar a mensagem, est√° funcionando!
:::

### Op√ß√£o B: Neo4j AuraDB (Cloud - Gratuito at√© 200K n√≥s)

1. Acesse: https://neo4j.com/cloud/aura/
2. Crie conta gratuita
3. Crie nova inst√¢ncia AuraDB Free
4. Baixe as credenciais (arquivo `.txt` com URI, user, password)
5. Guarde essas credenciais em local seguro

---

## Passo 2: Instalar synesis2graph

```bash
pip install synesis2graph
```

Verifique a instala√ß√£o:

```bash
synesis2graph --version
```

Deve retornar: `synesis2graph version 0.1.2`

---

## Passo 3: Criar Arquivo de Configura√ß√£o

Crie um arquivo `neo4j_config.toml` no diret√≥rio do seu projeto:

### Para Neo4j Desktop:

```toml
[neo4j]
uri = "bolt://localhost:7687"
user = "neo4j"
password = "SuaSenhaAqui"
database = "neo4j"  # ou nome customizado
```

### Para Neo4j AuraDB:

```toml
[neo4j]
uri = "neo4j+s://xxxxx.databases.neo4j.io"  # Copie da suas credenciais
user = "neo4j"
password = "SuaSenhaAuraDB"
database = "neo4j"
```

:::{.callout-warning}
## Seguran√ßa
NUNCA comite `neo4j_config.toml` para Git! Adicione ao `.gitignore`:
```bash
echo "neo4j_config.toml" >> .gitignore
```
:::

---

## Passo 4: Executar a Exporta√ß√£o

```bash
synesis2graph --project meu_projeto.synp --config neo4j_config.toml
```

**Output esperado:**

```
üîç Carregando projeto Synesis...
‚úì Projeto v√°lido: meu_projeto
‚úì Template carregado: template.synt
‚úì Ontologia carregada: 15 conceitos, 4 rela√ß√µes

üîó Conectando ao Neo4j...
‚úì Conectado: bolt://localhost:7687

üöÄ Sincronizando grafo...
  [‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà] 100% - 234 n√≥s, 156 arestas

üìä Calculando m√©tricas...
‚úì Degree Centralidade
‚úì Betweenness Centralidade
‚úì Closeness Centralidade

‚úÖ Exporta√ß√£o conclu√≠da em 3.2s
```

:::{.callout-note}
## Checkpoint ‚úì
Abra o Neo4j Browser e execute:
```cypher
MATCH (n) RETURN count(n) AS total_nodes
```
Deve retornar o n√∫mero de n√≥s exportados.
:::

---

## Passo 5: Explorar o Grafo no Neo4j Browser

### Visualizar Todos os N√≥s

```cypher
MATCH (n)
RETURN n
LIMIT 100
```

### Visualizar C√≥digo Espec√≠fico

```cypher
MATCH (c:Code {name: "Custo"})
RETURN c
```

### Visualizar Rela√ß√µes de um C√≥digo

```cypher
MATCH path = (c:Code {name: "Custo"})-[r]->(target)
RETURN path
```

### Ver Anota√ß√µes Conectadas a um C√≥digo

```cypher
MATCH (i:Item)-[:HAS_CODE]->(c:Code {name: "Custo"})
RETURN i.quote AS citacao, i.memo AS interpretacao
```

---

## Passo 6: Consultas Anal√≠ticas √öteis

### Top 10 C√≥digos Mais Frequentes

```cypher
MATCH (i:Item)-[:HAS_CODE]->(c:Code)
RETURN c.name AS codigo, count(i) AS frequencia
ORDER BY frequencia DESC
LIMIT 10
```

### C√≥digos que Co-ocorrem Frequentemente

```cypher
MATCH (i:Item)-[:HAS_CODE]->(c1:Code)
MATCH (i)-[:HAS_CODE]->(c2:Code)
WHERE c1 <> c2
RETURN c1.name AS codigo1, c2.name AS codigo2, count(i) AS coocorrencia
ORDER BY coocorrencia DESC
LIMIT 20
```

### Chains Mais Comuns

```cypher
MATCH (c1:Code)-[r:CHAIN_RELATION]->(c2:Code)
RETURN c1.name AS origem, r.relation_type AS relacao, c2.name AS destino, count(r) AS frequencia
ORDER BY frequencia DESC
```

### N√≥s Mais Centrais (Bridges)

```cypher
MATCH (c:Code)
WHERE c.betweenness_centrality IS NOT NULL
RETURN c.name AS codigo, c.betweenness_centrality AS centralidade
ORDER BY centralidade DESC
LIMIT 10
```

:::{.callout-tip}
## Interpreta√ß√£o
C√≥digos com alta betweenness centralidade s√£o "pontes" ‚Äî conceitos que conectam diferentes clusters tem√°ticos. S√£o candidatos para categorias centrais na sua an√°lise.
:::

---

## Passo 7: Atualizar o Grafo (Sincroniza√ß√£o Incremental)

Se voc√™ adicionar novas anota√ß√µes ao seu projeto Synesis:

### Modo Replace (Padr√£o)

```bash
# Apaga tudo e recria
synesis2graph --project meu_projeto.synp --config neo4j_config.toml
```

### Modo Merge (Atualiza√ß√£o Incremental)

Edite `neo4j_config.toml`:

```toml
[sync]
mode = "merge"  # Atualiza apenas o que mudou
```

Execute novamente:

```bash
synesis2graph --project meu_projeto.synp --config neo4j_config.toml
```

**Quando usar cada modo:**

| Modo | Quando Usar |
|------|-------------|
| `replace` | Mudan√ßas estruturais (novo template, ontologia refatorada) |
| `merge` | Adi√ß√£o de novas anota√ß√µes sem mudan√ßas estruturais |
| `append` | Apenas adicionar (nunca atualiza n√≥s existentes) |

---

## Passo 8: Calcular M√©tricas Avan√ßadas (Graph Data Science)

Se voc√™ tem Neo4j Enterprise ou instalou o plugin GDS:

### Instalar GDS Plugin (Neo4j Desktop)

1. Na tela do banco de dados, clique em "Plugins"
2. Instale "Graph Data Science Library"
3. Reinicie o banco de dados

### Habilitar no Config

Edite `neo4j_config.toml`:

```toml
[metrics]
native = true
gds = true  # Agora habilitado
```

### M√©tricas Dispon√≠veis

Ap√≥s exportar com GDS habilitado:

```cypher
MATCH (c:Code)
RETURN c.name AS codigo,
       c.degree_centrality AS degree,
       c.pagerank AS pagerank,
       c.betweenness_centrality AS betweenness,
       c.community_louvain AS comunidade
ORDER BY pagerank DESC
LIMIT 20
```

**Interpreta√ß√£o:**

- **PageRank alto**: C√≥digos que recebem muitas refer√™ncias de outros c√≥digos importantes
- **Community Louvain**: C√≥digos no mesmo cluster tem√°tico ter√£o mesmo n√∫mero de comunidade
- **Betweenness alto**: C√≥digos que conectam diferentes temas

---

## Troubleshooting

### Erro: `Connection refused (bolt://localhost:7687)`

**Causa:** Neo4j n√£o est√° rodando.

**Solu√ß√£o:**
```bash
# Neo4j Desktop: Clique em "Start" no banco de dados
# Neo4j Server:
neo4j start
```

### Erro: `Authentication failed`

**Causa:** Senha incorreta em `neo4j_config.toml`.

**Solu√ß√£o:**
1. Verifique a senha no Neo4j Desktop (Settings ‚Üí "Show Password")
2. Atualize `neo4j_config.toml`

### Erro: `Database not found: neo4j`

**Causa:** Nome do banco de dados incorreto.

**Solu√ß√£o:**
Execute no Neo4j Browser:
```cypher
SHOW DATABASES
```
Use o nome correto em `neo4j_config.toml`.

### Erro: `synesis.load() failed: Template not found`

**Causa:** Arquivo `.synp` com caminho incorreto para template.

**Solu√ß√£o:**
```bash
# Valide o projeto primeiro
synesis check meu_projeto.synp
```

Corrija os caminhos no `.synp`.

### Performance Lenta em Projetos Grandes

**Se voc√™ tem 10K+ anota√ß√µes:**

1. Aumente `batch_size`:
   ```toml
   [sync]
   batch_size = 5000
   ```

2. Desabilite m√©tricas temporariamente:
   ```toml
   [metrics]
   native = false
   gds = false
   ```

3. Calcule m√©tricas manualmente depois:
   ```cypher
   // Degree Centralidade
   CALL gds.degree.mutate('myGraph', {mutateProperty: 'degree'})
   ```

---

## Casos de Uso Avan√ßados

### Integra√ß√£o com Claude Desktop (MCP)

Ap√≥s exportar para Neo4j, voc√™ pode conectar com Claude Desktop via Model Context Protocol:

```toml
# ~/.claude/config.toml
[mcp.servers.synesis-graph]
command = "npx"
args = ["-y", "@neo4j/mcp-server", "--uri", "bolt://localhost:7687", "--user", "neo4j", "--password", "SuaSenha"]
```

Agora Claude pode consultar seu grafo diretamente em linguagem natural!

Consulte: https://modelcontextprotocol.io/docs/

### Exportar Visualiza√ß√£o para Publica√ß√£o

Use Bloom (Neo4j Enterprise) ou Neodash (open-source):

```bash
# Instalar Neodash
docker run -p 5005:5005 neo4jlabs/neodash:latest
```

Acesse `http://localhost:5005` e conecte ao seu grafo.

### An√°lise de Evolu√ß√£o Temporal

Se suas anota√ß√µes t√™m timestamps:

```cypher
MATCH (i:Item)
WHERE i.timestamp IS NOT NULL
WITH i, i.timestamp AS time
ORDER BY time
RETURN date(time) AS data, count(i) AS anotacoes_por_dia
```

---

## Refer√™ncias

Para conceitos sobre grafos de conhecimento:
- [Conceitos de Knowledge Graphs](../explanation/knowledge_graphs.qmd)

Para detalhes da API Synesis:
- [API Synesis (synesis.load)](../reference/synesis_load.qmd)

Para Cypher Query Language:
- [Neo4j Cypher Manual](https://neo4j.com/docs/cypher-manual/)

---

**Ficou com d√∫vidas?** Abra uma issue no [reposit√≥rio synesis2graph](https://github.com/synesis-lang/synesis2graph) ou consulte [GitHub Discussions](https://github.com/synesis-lang/synesis/discussions).
